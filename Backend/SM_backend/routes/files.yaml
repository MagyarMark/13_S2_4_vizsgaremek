tags:
  - name: Files
    description: Fájl és beadás kezelés

components:
  schemas:
    ErrorResponse:
      type: object
      properties:
        success:
          type: boolean
          example: false
        message:
          type: string
          example: Hibás adatok
        error:
          type: string
          example: Hibaüzenet
        errors:
          type: array
          items:
            type: object
    UploadHistoryItem:
      type: object
      properties:
        id:
          type: integer
          example: 12
        file_nev:
          type: string
          example: szamonkeres.pdf
        file_meret:
          type: integer
          example: 204800
        file_tipus:
          type: string
          example: application/pdf
        feltoltes_idopont:
          type: string
          format: date-time
          example: 2026-02-10T08:15:30
        file_eleresiut:
          type: string
          example: uploads/2026/szamonkeres.pdf
        beadas_id:
          type: integer
          nullable: true
          example: 3
    BeadasFileItem:
      type: object
      properties:
        id:
          type: integer
          example: 45
        file_nev:
          type: string
          example: szamonkeres2.docx
        file_meret:
          type: integer
          example: 102400
        file_tipus:
          type: string
          example: .docx
        feltoltes_idopont:
          type: string
          format: date-time
          example: 2026-02-10T09:10:00
        file_eleresiut:
          type: string
          example: uploads/2026/szamonkeres2.docx
        felhasznalonev:
          type: string
          example: diak1
        teljes_nev:
          type: string
          example: Kovács József
        email:
          type: string
          example: diak1@gmail.com
    BeadasListItem:
      type: object
      properties:
        id:
          type: integer
          example: 3
        feladat_id:
          type: integer
          example: 10
        felhasznalo_id:
          type: integer
          example: 7
        tanar_id:
          type: integer
          example: 2
        pontszam:
          type: number
          example: 87.5
        jegy:
          type: integer
          example: 4
        statusz:
          type: string
          example: ertekelt
        visszajelzes:
          type: string
          example: Jó munka!
        bekuldes_idopont:
          type: string
          format: date-time
          example: 2026-02-08T14:22:00
        ertekeles_idopont:
          type: string
          format: date-time
          nullable: true
          example: 2026-02-09T09:00
        student_name:
          type: string
          example: Kovács József
        task_name:
          type: string
          example: Első számonkérés
    BeadasCreateRequest:
      type: object
      required:
        - feladat_id
        - felhasznalo_id
        - tanar_id
        - pontszam
        - jegy
        - statusz
        - visszajelzes
      properties:
        feladat_id:
          type: integer
          example: 10
        felhasznalo_id:
          type: integer
          example: 7
        tanar_id:
          type: integer
          example: 2
        pontszam:
          type: number
          example: 87.5
        jegy:
          type: integer
          example: 4
        statusz:
          type: string
          example: beadva
          enum: [beadva, ertekelt, javitasra_visszaadva]
        visszajelzes:
          type: string
          example: Várom az értékelést.
        ertekeles_idopont:
          type: string
          format: date-time
          nullable: true
          example: 2026-02-09T09:00
    BeadasUpdateRequest:
      type: object
      properties:
        pontszam:
          type: number
          example: 90
        jegy:
          type: integer
          example: 5
        statusz:
          type: string
          enum: [beadva, ertekelt, javitasra_visszaadva]
          example: ertekelt
        visszajelzes:
          type: string
          example: Nagyon jó munka.
    BeadasStatusUpdateRequest:
      type: object
      required:
        - statusz
      properties:
        statusz:
          type: string
          enum: [beküldve, értékelve]
          example: értékelve

paths:
  /api/files/feltoltesek:
    get:
      summary: Felhasználó feltöltési előzményei
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - in: query
          name: beadas_id
          required: false
          schema:
            type: integer
          description: Szűrés beadás azonositó szerint
      responses:
        '200':
          description: Feltöltési előzmények listája
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      felhasznalo_id:
                        type: integer
                        example: 7
                      felhasznalonev:
                        type: string
                        example: diak1
                      uploads:
                        type: array
                        items:
                          $ref: '#/components/schemas/UploadHistoryItem'
                      count:
                        type: integer
                        example: 2
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Érvénytelen token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/files/beadas:
    get:
      summary: Beadások listázása
      tags: [Files]
      security:
        - bearerAuth: []
      responses:
        '200':
          description: Beadás lista
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      beadasList:
                        type: array
                        items:
                          $ref: '#/components/schemas/BeadasListItem'
                      count:
                        type: integer
                        example: 12
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Érvénytelen token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    post:
      summary: Új beadás létrehozása
      tags: [Files]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BeadasCreateRequest'
      responses:
        '201':
          description: Beadás létrehozva
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Sikeres beadás létrehozas
                  data:
                    type: object
                    properties:
                      beadas:
                        $ref: '#/components/schemas/BeadasListItem'
        '400':
          description: Hibás adatok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Érvénytelen token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/files/beadas/{beadas_id}:
    get:
      summary: Beadás fájljainak listázása
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: beadas_id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Beadás fájljai
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      beadas_id:
                        type: integer
                        example: 3
                      files:
                        type: array
                        items:
                          $ref: '#/components/schemas/BeadasFileItem'
                      count:
                        type: integer
                        example: 2
        '404':
          description: Beadás nem található
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Token szükseges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Érvénytelen token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

    put:
      summary: Beadás frissitese
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: beadas_id
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BeadasUpdateRequest'
      responses:
        '200':
          description: Beadás frissítve
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Beadás sikeresen frissítve
                  data:
                    type: object
                    properties:
                      beadas:
                        $ref: '#/components/schemas/BeadasListItem'
        '400':
          description: Hibás adatok vagy nincs frissítendő adat
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Nincs jogosultság a frissítéshez
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Beadás nem található
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'


  /api/files/beadas/{beadas_id}/statusz:
    patch:
      summary: Beadás státusz frissítése
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: beadas_id
          required: true
          schema:
            type: integer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BeadasStatusUpdateRequest'
      responses:
        '200':
          description: Beadás státusz frissítve
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Beadás státusza sikeresen frissítve
                  data:
                    type: object
                    properties:
                      beadas:
                        $ref: '#/components/schemas/BeadasListItem'
        '400':
          description: Hibás adatok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Nincs jogosultság a frissítéshez
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Beadás nem található
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/upload:
    post:
      summary: Fájl feltöltés
      tags: [Files]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                feladat_id:
                  type: integer
                  description: A feladat azonosítója (query-ben is megadható)
                  example: 10
                files:
                  type: object
                  additionalProperties:
                    type: string
                    format: binary
      responses:
        '200':
          description: Feltöltés sikeres
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: success
                  message:
                    type: string
                    example: 2 fájl sikeresen feltöltve
                  uploadedFiles:
                    type: array
                    items:
                      type: object
                      properties:
                        name:
                          type: string
                          example: beadando.pdf
                        id:
                          type: integer
                          example: 45
                  uploadInfo:
                    type: object
                    properties:
                      felhasznalo_id:
                        type: integer
                        example: 7
                      felhasznalonev:
                        type: string
                        example: diak1
                      feladat_id:
                        type: integer
                        example: 10
        '400':
          description: Hibás adatok
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '403':
          description: Érvénytelen token
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/files/{file_id}:
    delete:
      summary: Fájl törlése  
      tags: [Files]
      security:
        - bearerAuth: []
      parameters:
        - in: path
          name: file_id
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: Fájl törölve
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Fájl sikeresen törölve
                  data:
                    type: object
                    properties:
                      deleted_id:
                        type: integer
                        example: 45
                      file_nev:
                        type: string
                        example: beadando_v2.docx
        '403':
          description: Nincs jogosultság a törléshez
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '404':
          description: Fájl nem található
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '401':
          description: Token szükséges vagy lejárt
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
        '500':
          description: Szerver hiba
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
